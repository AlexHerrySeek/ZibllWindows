<ui:FluentWindow x:Class="ZibllWindows.BackupPage"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 Title="Sao lưu dữ liệu"
                 Width="900"
                 Height="700"
                 WindowStartupLocation="CenterOwner"
                 ResizeMode="CanResize">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="Sao lưu dữ liệu" 
                       FontSize="24" 
                       FontWeight="Bold"
                       Margin="0,0,0,10"/>
            <TextBlock Text="Sao lưu Desktop, Downloads, Documents, Pictures từ tất cả các ổ đĩa"
                       FontSize="14"
                       Foreground="Gray"/>
        </StackPanel>
        
        <!-- ListView -->
        <ui:Card Grid.Row="1" Margin="0,0,0,15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                    <ui:Button x:Name="BtnSelectAll"
                               Content="Chọn tất cả"
                               Click="BtnSelectAll_Click"
                               Margin="0,0,10,0"/>
                    <ui:Button x:Name="BtnUnselectAll"
                               Content="Bỏ chọn tất cả"
                               Click="BtnUnselectAll_Click"
                               Margin="0,0,10,0"/>
                    <ui:Button x:Name="BtnRescan"
                               Content="Quét lại"
                               Click="BtnRescan_Click"/>
                </StackPanel>
                
                <ListView x:Name="ListViewFolders"
                          Grid.Row="1"
                          SelectionMode="Single">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Chọn" Width="50">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsSelected}" 
                                                  Checked="CheckBox_Checked"
                                                  Unchecked="CheckBox_Unchecked"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Người dùng" Width="150" DisplayMemberBinding="{Binding UserName}"/>
                            <GridViewColumn Header="Thư mục" Width="120" DisplayMemberBinding="{Binding FolderName}"/>
                            <GridViewColumn Header="Đường dẫn" Width="500" DisplayMemberBinding="{Binding FullPath}"/>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Grid>
        </ui:Card>
        
        <!-- Destination -->
        <ui:Card Grid.Row="2" Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="Thư mục đích:" 
                           FontWeight="SemiBold"
                           Margin="0,0,0,10"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="TxtDestination"
                             Grid.Column="0"
                             Margin="0,0,10,0"
                             Padding="10,8"/>
                    <ui:Button x:Name="BtnBrowse"
                               Grid.Column="1"
                               Content="Chọn..."
                               Click="BtnBrowse_Click"/>
                </Grid>
                <CheckBox x:Name="ChkSubFolder"
                          Content="Tạo thư mục con với ngày giờ (YYYYMMDD_HHMMSS)"
                          Margin="0,10,0,0"/>
            </StackPanel>
        </ui:Card>
        
        <!-- Buttons and Progress -->
        <StackPanel Grid.Row="3">
            <ProgressBar x:Name="ProgressBar"
                         Value="0"
                         Maximum="100"
                         Height="8"
                         Margin="0,0,0,10"
                         Visibility="Collapsed"/>
            <TextBlock x:Name="LblStatus"
                       Text="Sẵn sàng..."
                       FontSize="12"
                       Foreground="Gray"
                       Margin="0,0,0,10"/>
            <TextBlock x:Name="LblFile"
                       Text=""
                       FontSize="11"
                       Foreground="DarkGray"
                       TextWrapping="Wrap"
                       Margin="0,0,0,10"
                       Visibility="Collapsed"/>
            <ScrollViewer x:Name="ScrollLog"
                          Height="150"
                          VerticalScrollBarVisibility="Auto"
                          Margin="0,0,0,10"
                          Visibility="Collapsed">
                <TextBox x:Name="TxtLog"
                         IsReadOnly="True"
                         TextWrapping="Wrap"
                         VerticalScrollBarVisibility="Auto"/>
            </ScrollViewer>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <ui:Button x:Name="BtnBackup"
                           Content="Bắt đầu sao lưu"
                           Appearance="Primary"
                           Click="BtnBackup_Click"
                           Margin="0,0,10,0"/>
                <ui:Button x:Name="BtnPause"
                           Content="Tạm dừng"
                           Click="BtnPause_Click"
                           IsEnabled="False"
                           Margin="0,0,10,0"
                           Visibility="Collapsed"/>
                <ui:Button x:Name="BtnCancel"
                           Content="Hủy"
                           Click="BtnCancel_Click"
                           IsEnabled="False"
                           Visibility="Collapsed"/>
            </StackPanel>
        </StackPanel>
    </Grid>
</ui:FluentWindow>
